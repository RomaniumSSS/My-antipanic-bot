# –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∫–ª–∏–∫–æ–≤

**–î–∞—Ç–∞**: 2025-12-18
**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**: –ü–ª–∞–Ω 005, –ø—É–Ω–∫—Ç 1
**–ö–æ–º–º–∏—Ç**: clean-backend branch

---

## üéØ –¶–µ–ª—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ decorator `@prevent_double_click()` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∫–ª–∏–∫–∏ –Ω–∞ callback buttons –≤–æ –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö handler'–∞—Ö.

---

## üìã –¢–µ—Å—Ç-–∫–µ–π—Å—ã

### 1Ô∏è‚É£ Morning Flow (morning.py)

#### TC-01: –í—ã–±–æ—Ä —Ü–µ–ª–∏ (–µ—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ)
**–®–∞–≥–∏**:
1. –°–æ–∑–¥–∞–π 2 –∞–∫—Ç–∏–≤–Ω—ã–µ —Ü–µ–ª–∏ —á–µ—Ä–µ–∑ –±–æ—Ç–∞
2. –í—ã–∑–æ–≤–∏ `/morning`
3. –ë—ã—Å—Ç—Ä–æ –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –≤—ã–±–æ—Ä–∞ —Ü–µ–ª–∏ **–Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ–¥—Ä—è–¥** (5-10 –∫–ª–∏–∫–æ–≤)

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –ü–µ—Ä–≤—ã–π –∫–ª–∏–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —à–∫–∞–ª–∞ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è
- ‚úÖ –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∫–ª–∏–∫–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è toast "‚è≥ –£–∂–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é, –ø–æ–¥–æ–∂–¥–∏ —Å–µ–∫—É–Ω–¥—É..."
- ‚úÖ –ù–ï —Å–æ–∑–¥–∞—ë—Ç—Å—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ body steps
- ‚úÖ –ù–ï –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ AI

---

#### TC-02: –û—Ü–µ–Ω–∫–∞ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è –î–û
**–®–∞–≥–∏**:
1. –í—ã–∑–æ–≤–∏ `/morning` ‚Üí –≤—ã–±–µ—Ä–∏ —Ü–µ–ª—å
2. –ë—ã—Å—Ç—Ä–æ –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É "5" –Ω–∞ —à–∫–∞–ª–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è **–Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ–¥—Ä—è–¥**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –ü–µ—Ä–≤—ã–π –∫–ª–∏–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è, —Å–æ–∑–¥–∞—ë—Ç—Å—è body step
- ‚úÖ –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∫–ª–∏–∫–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è —Å toast
- ‚úÖ –°–æ–∑–¥–∞—ë—Ç—Å—è —Ä–æ–≤–Ω–æ –û–î–ò–ù body step (–ø—Ä–æ–≤–µ—Ä—å –≤ –ë–î –∏–ª–∏ –ª–æ–≥–∞—Ö)
- ‚úÖ –ù–ï –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ AI –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —à–∞–≥–∞

---

#### TC-03: –û—Ü–µ–Ω–∫–∞ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è –ü–û–°–õ–ï
**–®–∞–≥–∏**:
1. –ü—Ä–æ–π–¥–∏ morning flow –¥–æ –æ—Ü–µ–Ω–∫–∏ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è –ø–æ—Å–ª–µ body step
2. –ë—ã—Å—Ç—Ä–æ –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É "3" –Ω–∞ —à–∫–∞–ª–µ **–Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ–¥—Ä—è–¥**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –ü–µ—Ä–≤—ã–π –∫–ª–∏–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —É–≥–ª—É–±–∏—Ç—å—Å—è
- ‚úÖ –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∫–ª–∏–∫–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- ‚úÖ `tension_after` –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –û–î–ò–ù —Ä–∞–∑

---

#### TC-04: –£–≥–ª—É–±–∏—Ç—å—Å—è/–ó–∞–≤–µ—Ä—à–∏—Ç—å
**–®–∞–≥–∏**:
1. –ü—Ä–æ–π–¥–∏ morning flow –¥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —É–≥–ª—É–±–∏—Ç—å—Å—è
2. –ë—ã—Å—Ç—Ä–æ –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É "üöÄ –£–≥–ª—É–±–∏—Ç—å—Å—è" **–Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ–¥—Ä—è–¥**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –ü–µ—Ä–≤—ã–π –∫–ª–∏–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è, —Å–æ–∑–¥–∞—ë—Ç—Å—è deepening step
- ‚úÖ –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∫–ª–∏–∫–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- ‚úÖ –°–æ–∑–¥–∞—ë—Ç—Å—è —Ä–æ–≤–Ω–æ –û–î–ò–ù deepening step
- ‚úÖ –ù–ï –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ AI

---

### 2Ô∏è‚É£ Steps Flow (steps.py)

#### TC-05: –û—Ç–º–µ—Ç–∫–∞ "–°–¥–µ–ª–∞–ª" (step_done)
**–®–∞–≥–∏**:
1. –ü–æ–ª—É—á–∏ —à–∞–≥ —á–µ—Ä–µ–∑ `/morning`
2. –ë—ã—Å—Ç—Ä–æ –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É "–®–∞–≥ 1" **–Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ–¥—Ä—è–¥**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –ü–µ—Ä–≤—ã–π –∫–ª–∏–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è, –Ω–∞—á–∏—Å–ª—è–µ—Ç—Å—è XP
- ‚úÖ –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∫–ª–∏–∫–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- ‚úÖ XP –Ω–∞—á–∏—Å–ª—è–µ—Ç—Å—è —Ä–æ–≤–Ω–æ –û–î–ò–ù —Ä–∞–∑ (–ø—Ä–æ–≤–µ—Ä—å –±–∞–ª–∞–Ω—Å –≤ –ë–î)
- ‚úÖ Streak –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –û–î–ò–ù —Ä–∞–∑

---

#### TC-06: –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —à–∞–≥ (step_skip)
**–®–∞–≥–∏**:
1. –ü–æ–ª—É—á–∏ —à–∞–≥ —á–µ—Ä–µ–∑ `/morning`
2. –ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É "üÜò"
3. –ë—ã—Å—Ç—Ä–æ –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É "üö´ –ù–µ –ø–æ–¥–æ—à–ª–æ" **–Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ–¥—Ä—è–¥**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –ü–µ—Ä–≤—ã–π –∫–ª–∏–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è, —à–∞–≥ –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ skipped
- ‚úÖ –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∫–ª–∏–∫–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- ‚úÖ –õ–æ–≥ skipped –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –û–î–ò–ù —Ä–∞–∑

---

#### TC-07: –ó–∞—Å—Ç—Ä—è–ª –Ω–∞ —à–∞–≥–µ (step_stuck)
**–®–∞–≥–∏**:
1. –ü–æ–ª—É—á–∏ —à–∞–≥ —á–µ—Ä–µ–∑ `/morning`
2. –ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É "üÜò"
3. –ë—ã—Å—Ç—Ä–æ –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É "ü§∑ –ù–µ –∑–Ω–∞—é —Å —á–µ–≥–æ" **–Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ–¥—Ä—è–¥**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –ü–µ—Ä–≤—ã–π –∫–ª–∏–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è, –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è stuck flow
- ‚úÖ –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∫–ª–∏–∫–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- ‚úÖ –ù–ï —Å–æ–∑–¥–∞—ë—Ç—Å—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö AI –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –º–∏–∫—Ä–æ—Ö–∏—Ç–æ–≤

---

#### TC-08: –û—Ü–µ–Ω–∫–∞ –¥–Ω—è (handle_day_rating)
**–®–∞–≥–∏**:
1. –í—ã–∑–æ–≤–∏ `/evening`
2. –ë—ã—Å—Ç—Ä–æ –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É "üòä 7" –Ω–∞ —à–∫–∞–ª–µ **–Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ–¥—Ä—è–¥**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –ü–µ—Ä–≤—ã–π –∫–ª–∏–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è, –æ—Ü–µ–Ω–∫–∞ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è
- ‚úÖ –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∫–ª–∏–∫–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- ‚úÖ –û—Ü–µ–Ω–∫–∞ –¥–Ω—è –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ –ë–î –û–î–ò–ù —Ä–∞–∑

---

### 3Ô∏è‚É£ Stuck Flow (stuck.py)

#### TC-09: –í—ã–±–æ—Ä –±–ª–æ–∫–µ—Ä–∞ "–ù–µ–ø–æ–Ω—è—Ç–Ω–æ" (blocker_unclear)
**–®–∞–≥–∏**:
1. –í—ã–∑–æ–≤–∏ `/stuck` –∏–ª–∏ –Ω–∞–∂–º–∏ "ü§∑ –ù–µ –∑–Ω–∞—é —Å —á–µ–≥–æ" –Ω–∞ —à–∞–≥–µ
2. –ë—ã—Å—Ç—Ä–æ –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É "ü§î –ù–µ–ø–æ–Ω—è—Ç–Ω–æ" **–Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ–¥—Ä—è–¥**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –ü–µ—Ä–≤—ã–π –∫–ª–∏–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è, –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –º–∏–∫—Ä–æ—Ö–∏—Ç—ã
- ‚úÖ –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∫–ª–∏–∫–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- ‚úÖ AI –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ä–æ–≤–Ω–æ –û–î–ò–ù —Ä–∞–∑ (–ø—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏: "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∏–∫—Ä–æ—Ö–∏—Ç–æ–≤ —á–µ—Ä–µ–∑ AI...")

---

#### TC-10: –í—ã–±–æ—Ä –±–ª–æ–∫–µ—Ä–∞ "–î—Ä—É–≥–æ–µ" (blocker_other)
**–®–∞–≥–∏**:
1. –í—ã–∑–æ–≤–∏ `/stuck`
2. –ë—ã—Å—Ç—Ä–æ –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É "üí¨ –î—Ä—É–≥–æ–µ" **–Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ–¥—Ä—è–¥**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –ü–µ—Ä–≤—ã–π –∫–ª–∏–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è, –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è –æ–ø–∏—Å–∞–Ω–∏–µ
- ‚úÖ –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∫–ª–∏–∫–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- ‚úÖ FSM state –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ `describing_blocker` –û–î–ò–ù —Ä–∞–∑

---

#### TC-11: –í—ã–±–æ—Ä –≤–∞—Ä–∏–∞–Ω—Ç–∞ –º–∏–∫—Ä–æ—Ö–∏—Ç–∞ (microhit_option_selected)
**–®–∞–≥–∏**:
1. –í—ã–∑–æ–≤–∏ `/stuck` ‚Üí –≤—ã–±–µ—Ä–∏ –±–ª–æ–∫–µ—Ä ‚Üí –ø–æ–ª—É—á–∏ 2 –≤–∞—Ä–∏–∞–Ω—Ç–∞ –º–∏–∫—Ä–æ—Ö–∏—Ç–æ–≤
2. –ë—ã—Å—Ç—Ä–æ –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É "1Ô∏è‚É£" **–Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ–¥—Ä—è–¥**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –ü–µ—Ä–≤—ã–π –∫–ª–∏–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è, —Å–æ–∑–¥–∞—ë—Ç—Å—è stuck step
- ‚úÖ –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∫–ª–∏–∫–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- ‚úÖ –°–æ–∑–¥–∞—ë—Ç—Å—è —Ä–æ–≤–Ω–æ –û–î–ò–ù stuck step –≤ –ë–î
- ‚úÖ AI –ù–ï –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è —à–∞–≥–∞

---

#### TC-12: –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å "–î–µ–ª–∞—é/–ù–µ –ø–æ—à–ª–æ" (microhit_feedback)
**–®–∞–≥–∏**:
1. –ü—Ä–æ–π–¥–∏ stuck flow –¥–æ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏
2. –ë—ã—Å—Ç—Ä–æ –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É "‚úÖ –î–µ–ª–∞—é" **–Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ–¥—Ä—è–¥**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –ü–µ—Ä–≤—ã–π –∫–ª–∏–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è, –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
- ‚úÖ –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∫–ª–∏–∫–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- ‚úÖ Feedback –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ DailyLog –û–î–ò–ù —Ä–∞–∑

---

### 4Ô∏è‚É£ Edge Case: –û—à–∏–±–∫–∞ –≤ handler'–µ

#### TC-13: –°–±—Ä–æ—Å —Ñ–ª–∞–≥–∞ processing –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏
**–®–∞–≥–∏**:
1. –°–∏–º—É–ª–∏—Ä—É–π –æ—à–∏–±–∫—É –≤ handler'–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É–¥–∞–ª–∏ –∞–∫—Ç–∏–≤–Ω—É—é —Ü–µ–ª—å –∏–∑ –ë–î –≤–æ –≤—Ä–µ–º—è morning flow)
2. –í—ã–∑–æ–≤–∏ `/morning` ‚Üí –≤—ã–±–µ—Ä–∏ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ü–µ–ª—å
3. –ü–æ–ø—Ä–æ–±—É–π –Ω–∞–∂–∞—Ç—å –¥—Ä—É–≥—É—é –∫–Ω–æ–ø–∫—É

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –ü–µ—Ä–≤—ã–π –∫–ª–∏–∫ –≤—ã–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É –≤ handler'–µ
- ‚úÖ –§–ª–∞–≥ `processing` —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –≤ `finally` –±–ª–æ–∫–µ
- ‚úÖ –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∫–ª–∏–∫–∏ –ù–ï –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è (–º–æ–∂–Ω–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –±–æ—Ç–æ–º)

---

## üîç –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä—è—Ç—å

### –í –ª–æ–≥–∞—Ö –±–æ—Ç–∞ (Railway/–ª–æ–∫–∞–ª—å–Ω–æ):
```bash
# –ò—â–∏ —Å—Ç—Ä–æ–∫–∏ —Å "Double click prevented"
grep "Double click prevented" logs/bot.log

# –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ AI –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ä–æ–≤–Ω–æ 1 —Ä–∞–∑
grep "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∏–∫—Ä–æ—Ö–∏—Ç–æ–≤ —á–µ—Ä–µ–∑ AI" logs/bot.log
grep "Creating body step for user" logs/bot.log
```

### –í –ë–î (—á–µ—Ä–µ–∑ `check_user.py`):
```bash
# –ü—Ä–æ–≤–µ—Ä—å –∫–æ–ª-–≤–æ —à–∞–≥–æ–≤ –∑–∞ —Å–µ–≥–æ–¥–Ω—è
python -m src.scripts.check_user 579067869

# –ü—Ä–æ–≤–µ—Ä—å XP –∏ streak
# –£–±–µ–¥–∏—Å—å, —á—Ç–æ XP –Ω–µ –∑–∞–¥–≤–æ–∏–ª—Å—è –ø–æ—Å–ª–µ –¥–≤–æ–π–Ω–æ–≥–æ –∫–ª–∏–∫–∞ –Ω–∞ "–°–¥–µ–ª–∞–ª"
```

### –í Telegram:
- –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∫–ª–∏–∫–∞—Ö –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–ª—è—Ç—å—Å—è toast "‚è≥ –£–∂–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é, –ø–æ–¥–æ–∂–¥–∏ —Å–µ–∫—É–Ω–¥—É..."
- –ö–Ω–æ–ø–∫–∏ –ù–ï –¥–æ–ª–∂–Ω—ã –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

- [ ] –í—Å–µ 13 —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤ –ø—Ä–æ—à–ª–∏
- [ ] –í –ª–æ–≥–∞—Ö –µ—Å—Ç—å –∑–∞–ø–∏—Å–∏ "Double click prevented" –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∫–ª–∏–∫–æ–≤
- [ ] –í –ë–î –Ω–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ (—à–∞–≥–∏, XP, –æ—Ü–µ–Ω–∫–∏)
- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç feedback toast –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∫–ª–∏–∫–∞—Ö
- [ ] –§–ª–∞–≥ `processing` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –æ—à–∏–±–æ–∫

---

## üêõ –ï—Å–ª–∏ —Ç–µ—Å—Ç –ø—Ä–æ–≤–∞–ª–µ–Ω

1. –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ decorator `@prevent_double_click()` –ø—Ä–∏–º–µ–Ω—ë–Ω –∫ handler'—É
2. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏: —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∫–ª–∏–∫–µ?
3. –ü—Ä–æ–≤–µ—Ä—å FSM state: –Ω–µ –æ—á–∏—â–∞–µ—Ç—Å—è –ª–∏ –æ–Ω –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ?
4. –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –≤ handler'–µ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `state.clear()` –¥–æ —Å–±—Ä–æ—Å–∞ —Ñ–ª–∞–≥–∞

---

## üìù –û—Ç—á—ë—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

–ü–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø–æ–ª–Ω–∏:

```markdown
### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (YYYY-MM-DD)

**–¢–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫**: @username
**–û–∫—Ä—É–∂–µ–Ω–∏–µ**: Railway production / Local
**–í–µ—Ä—Å–∏—è**: commit hash

| TC | –°—Ü–µ–Ω–∞—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ |
|----|----------|--------|-------------|
| TC-01 | –í—ã–±–æ—Ä —Ü–µ–ª–∏ | ‚úÖ Pass / ‚ùå Fail | ... |
| TC-02 | –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –î–û | ‚úÖ Pass / ‚ùå Fail | ... |
| TC-03 | –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –ü–û–°–õ–ï | ‚úÖ Pass / ‚ùå Fail | ... |
| TC-04 | –£–≥–ª—É–±–∏—Ç—å—Å—è | ‚úÖ Pass / ‚ùå Fail | ... |
| TC-05 | –®–∞–≥ —Å–¥–µ–ª–∞–ª | ‚úÖ Pass / ‚ùå Fail | ... |
| TC-06 | –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å | ‚úÖ Pass / ‚ùå Fail | ... |
| TC-07 | –ó–∞—Å—Ç—Ä—è–ª –Ω–∞ —à–∞–≥–µ | ‚úÖ Pass / ‚ùå Fail | ... |
| TC-08 | –û—Ü–µ–Ω–∫–∞ –¥–Ω—è | ‚úÖ Pass / ‚ùå Fail | ... |
| TC-09 | –ë–ª–æ–∫–µ—Ä –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ | ‚úÖ Pass / ‚ùå Fail | ... |
| TC-10 | –ë–ª–æ–∫–µ—Ä –¥—Ä—É–≥–æ–µ | ‚úÖ Pass / ‚ùå Fail | ... |
| TC-11 | –í—ã–±–æ—Ä –º–∏–∫—Ä–æ—Ö–∏—Ç–∞ | ‚úÖ Pass / ‚ùå Fail | ... |
| TC-12 | –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å | ‚úÖ Pass / ‚ùå Fail | ... |
| TC-13 | –û—à–∏–±–∫–∞ handler | ‚úÖ Pass / ‚ùå Fail | ... |

**–ò—Ç–æ–≥–æ**: X/13 Pass

**–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –±–∞–≥–∏**: (–µ—Å–ª–∏ –µ—Å—Ç—å)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**: (–µ—Å–ª–∏ –µ—Å—Ç—å)
```

---

**–ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é!** üöÄ
